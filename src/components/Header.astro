---
import Nav from "@components/Nav.astro";

const is_on_homepage = Astro.url.pathname === "/";
---

<script define:vars={{ is_on_homepage }}>
/* eslint-disable @typescript-eslint/explicit-function-return-type */
function set_header_bg() {
	const sections_container = document.getElementById("hero");
	const header = document.querySelector("header");

	// TODO: refactor!
	if (is_on_homepage) {
		const must_set_solid_bg = sections_container.getBoundingClientRect().y <= ((window.innerHeight) * -1);

		header.classList.add("loaded");

		if (must_set_solid_bg) {
			header.classList.add("bg-site-white");
			header.classList.add("dark:bg-site-black");

			header.classList.add("text-site-black");
			header.classList.add("dark:text-site-white");
			header.classList.remove("text-site-white");
		} else {
			header.classList.remove("bg-site-white");
			header.classList.remove("dark:bg-dark");
		}
	}
}
window.addEventListener("load", set_header_bg);
window.addEventListener("scroll", set_header_bg);
</script>


<header class:list={{ "bg-site-white dark:bg-site-black": !is_on_homepage }}>
	<div class="container">
		<Nav />
	</div>
</header>

<style lang="scss">
header {
	position: fixed;
	width: 100%;
	top: 0;
	z-index: 999;
}

.container {
	@apply h-full flex items-center justify-start sm:justify-center;
}
</style>
