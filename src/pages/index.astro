---
import BaseLayout from "@layouts/BaseLayout.astro";

import About from "@components/About.astro";
---

<script>
function set_header_bg():void {
	const sections_container = document.getElementById("hero") as HTMLDivElement;
	const header = document.querySelector("header") as HTMLElement;
	const must_set_solid_bg = window.location.pathname === "/"
		&& sections_container.getBoundingClientRect().y <= (window.innerHeight * -1); // !: works on homepage only

	// TODO: refactor!
	if (must_set_solid_bg) {
		header.classList.add("bg-white");
		header.classList.add("dark:bg-dark");

		header.classList.add("text-neutral-600");
		header.classList.add("dark:text-white");
		header.classList.remove("text-white");
	} else {
		header.classList.remove("bg-white");
		header.classList.remove("dark:bg-dark");

		header.classList.remove("text-neutral-600");
		header.classList.remove("dark:text-white");
		header.classList.add("text-white");
	}
}
window.addEventListener("load", set_header_bg);
window.addEventListener("scroll", set_header_bg);
</script>

<BaseLayout page_title="Home">
	<section class="hero about-me" id="hero">
		<div class="container">
			<h1 class="title">
				Hello, I'm
				<strong class="name">Jarlem Red</strong>
			</h1>
			<p class="nickname">
				but you can call me <strong>lem</strong>.
			</p>
			<a class="about-link" href="/#about">Get to know more about me.</a>
		</div>
	</section>

	<div class="container" id="sections-container">
		<section id="projects">
			<h1 class="title">Projects</h1>
			<ul class="projects-container">
				{[1,2,3,4,5,6].map(item => (
					<li class={`project-item project-${item}`}>project {item}</li>
				))}
			</ul>
			<a href="/projects">See all the things I've built</a>
		</section>

		<section id="about">
			<h1 class="title">Who am I?</h1>
			<About />
		</section>

		<section id="contact">
			<h1 class="title">Get in touch</h1>
			<form class="email-form">
				<!-- TODO: make into component and functional -->
				<input type="email">
				<textarea name="" id="" cols="30" rows="10"></textarea>
				<small>Or send an email at <a href="jarlemdeperalta@gmail.com">jarlemdeperalta@gmail.com</a></small>
				<button type="submit">Send</button>
			</form>
		</section>
	</div>
</BaseLayout>

<style lang="scss">
@import "@styles/variables";

section {
	@apply pb-[2rem]
}

.container {
	@apply mx-auto px-[1.5rem] sm:px-0;
}

.hero {
	@apply pt-20;
	background-image: linear-gradient(#000a, #000a), url("src/assets/hero_portrait.jpg");
	background-origin: border-box;
	background-position: center;
	background-size: cover;
	height: 100vh;

	.container {
		@apply
			h-[inherit]
			flex flex-col items-center justify-center
			text-center text-white
		;
	}

	h1 .name {
		@apply block text-12 sm:text-16;
	}

	.nickname {
		@apply uppercase text-neutral-300;
	}

	.about-link {
		@apply mt-8;
	}
}

.title {
	@apply my-8 text-8 sm:text-12;
}

#projects, #about, #contact {

	padding-top: $header-height;

	.title {
		@apply text-center font-bold;
	}
}

.projects-container {
	@apply
		mb-[1rem]
		grid gap-[.5rem]
		sm:grid-cols-3 sm:grid-rows-3
	;

	.project-item {
		@apply rounded py-20 bg-neutral-200 dark:bg-dark-300;

		text-align: center;
	}

	.project-1, .project-4, .project-5 {
		@apply sm:col-span-2;
	}
}

.email-form {
	@apply flex flex-col gap-y-2 items-start;

	& > *:not(small) {
		@apply
			rounded
			bg-neutral-200 dark:bg-dark-300
		;
	}

	input, textarea {
		@apply px-4 py-2 w-full;
	}

	button {
		@apply px-4 py-2 bg-neutral-200;
	}
}
</style>
